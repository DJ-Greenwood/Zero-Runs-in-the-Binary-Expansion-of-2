<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1200">
    <!-- Styles -->
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
        </marker>
    </defs>
    
    <!-- Start -->
    <rect x="450" y="20" width="100" height="50" rx="25" fill="#ff99ff" stroke="#333" stroke-width="2"/>
    <text x="500" y="50" text-anchor="middle" fill="#000">Start</text>
    
    <!-- GPU Check -->
    <path d="M 450 100 L 550 150 L 450 200 L 350 150 Z" fill="#ffeb99" stroke="#333" stroke-width="2"/>
    <text x="450" y="155" text-anchor="middle" fill="#000" font-size="14">GPU</text>
    <text x="450" y="175" text-anchor="middle" fill="#000" font-size="14">Available?</text>
    
    <!-- Initialization -->
    <rect x="400" y="230" width="200" height="80" rx="5" fill="#fff" stroke="#333" stroke-width="2"/>
    <text x="500" y="255" text-anchor="middle" fill="#000" font-size="14">Initialize Environment</text>
    <text x="500" y="275" text-anchor="middle" fill="#000" font-size="12">• Set precision (1M bits)</text>
    <text x="500" y="295" text-anchor="middle" fill="#000" font-size="12">• Configure block size (16)</text>
    
    <!-- Generate Binary -->
    <rect x="400" y="340" width="200" height="70" rx="5" fill="#fff" stroke="#333" stroke-width="2"/>
    <text x="500" y="365" text-anchor="middle" fill="#000" font-size="14">Generate Binary Expansion</text>
    <text x="500" y="385" text-anchor="middle" fill="#000" font-size="12">Convert √2 to binary sequence</text>
    
    <!-- Block Analysis -->
    <path d="M 400 440 L 600 440 L 600 560 L 400 560 L 400 440" fill="#bbf" stroke="#333" stroke-width="2"/>
    <text x="500" y="465" text-anchor="middle" fill="#000" font-size="14">Block Analysis Loop</text>
    <text x="500" y="485" text-anchor="middle" fill="#000" font-size="12">For each scale j:</text>
    <text x="500" y="505" text-anchor="middle" fill="#000" font-size="12">1. Compute block frequencies</text>
    <text x="500" y="525" text-anchor="middle" fill="#000" font-size="12">2. Calculate entropy H(j)</text>
    <text x="500" y="545" text-anchor="middle" fill="#000" font-size="12">3. Measure discrepancy D(j)</text>
    
    <!-- Block Size Decision -->
    <path d="M 450 590 L 550 640 L 450 690 L 350 640 Z" fill="#ffeb99" stroke="#333" stroke-width="2"/>
    <text x="450" y="635" text-anchor="middle" fill="#000" font-size="12">Block Size ></text>
    <text x="450" y="655" text-anchor="middle" fill="#000" font-size="12">MAX_BLOCK_SIZE?</text>
    
    <!-- Zero Run Analysis -->
    <rect x="400" y="720" width="200" height="100" rx="5" fill="#fff" stroke="#333" stroke-width="2"/>
    <text x="500" y="745" text-anchor="middle" fill="#000" font-size="14">Zero Run Analysis</text>
    <text x="500" y="765" text-anchor="middle" fill="#000" font-size="12">1. Detect 0→1 transitions</text>
    <text x="500" y="785" text-anchor="middle" fill="#000" font-size="12">2. Calculate run lengths</text>
    <text x="500" y="805" text-anchor="middle" fill="#000" font-size="12">3. Compute distributions</text>
    
    <!-- Statistical Tests -->
    <rect x="400" y="850" width="200" height="120" rx="5" fill="#fff" stroke="#333" stroke-width="2"/>
    <text x="500" y="875" text-anchor="middle" fill="#000" font-size="14">Statistical Analysis</text>
    <text x="500" y="895" text-anchor="middle" fill="#000" font-size="12">1. KS test (normality check)</text>
    <text x="500" y="915" text-anchor="middle" fill="#000" font-size="12">2. Entropy calculations</text>
    <text x="500" y="935" text-anchor="middle" fill="#000" font-size="12">3. Compare with theoretical</text>
    <text x="500" y="955" text-anchor="middle" fill="#000" font-size="12">bounds (2^-(k+1))</text>
    
    <!-- Test Results Decision -->
    <path d="M 450 1000 L 550 1050 L 450 1100 L 350 1050 Z" fill="#ffeb99" stroke="#333" stroke-width="2"/>
    <text x="450" y="1045" text-anchor="middle" fill="#000" font-size="12">Tests Pass</text>
    <text x="450" y="1065" text-anchor="middle" fill="#000" font-size="12">Threshold?</text>
    
    <!-- End -->
    <rect x="450" y="1130" width="100" height="50" rx="25" fill="#ff99ff" stroke="#333" stroke-width="2"/>
    <text x="500" y="1160" text-anchor="middle" fill="#000">End</text>
    
    <!-- Arrows and Labels -->
    <line x1="500" y1="70" x2="500" y2="100" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="420" y="95" text-anchor="middle" fill="#666" font-size="10">Check hardware</text>
    
    <line x1="500" y1="200" x2="500" y2="230" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="580" y="220" text-anchor="middle" fill="#666" font-size="10">Configure system</text>
    
    <line x1="500" y1="310" x2="500" y2="340" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="580" y="330" text-anchor="middle" fill="#666" font-size="10">Set parameters</text>
    
    <line x1="500" y1="410" x2="500" y2="440" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="580" y="430" text-anchor="middle" fill="#666" font-size="10">Binary sequence</text>
    
    <line x1="500" y1="560" x2="500" y2="590" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="500" y1="690" x2="500" y2="720" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <line x1="500" y1="820" x2="500" y2="850" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="580" y="840" text-anchor="middle" fill="#666" font-size="10">Run statistics</text>
    
    <line x1="500" y1="970" x2="500" y2="1000" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="500" y1="1100" x2="500" y2="1130" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- Alternative Paths -->
    <path d="M 350 150 C 250 150 250 330 400 330" fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="300" y="200" text-anchor="middle" fill="#666" font-size="10">Use CPU</text>
    
    <path d="M 350 640 C 250 640 250 800 400 800" fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="300" y="700" text-anchor="middle" fill="#666" font-size="10">Use sampling</text>
    
    <path d="M 350 1050 C 250 1050 250 900 400 900" fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="300" y="1000" text-anchor="middle" fill="#666" font-size="10">Adjust parameters</text>
    
    <!-- Loop arrow -->
    <path d="M 600 500 C 650 500 650 500 650 500" fill="none" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="650" y="490" text-anchor="middle" fill="#666" font-size="10">Next scale</text>
</svg>